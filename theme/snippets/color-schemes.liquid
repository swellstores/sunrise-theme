{% comment %}
  Renders color scheme css variables & classes

  Usage:
    {% render 'color-schemes' %}
{% endcomment %}

{%- liquid
  assign color_scheme_roles = 'background,text,text_secondary,button,button_border,button_label,secondary_button_label,secondary_button_border,primary_button_hover,primary_button_label_hover,secondary_button_border_hover,secondary_button_label_hover,borders_and_inputs,brand_highlight' | split: ','
-%}

{% style %}
    :root {
      {% for scheme in settings.color_schemes %}
        {% for role in color_scheme_roles %}
          {% assign role_value = scheme.settings[role] %}

          {% if role_value == blank %}
            /* Handle blank values by setting to transparent */
            --color-{{ scheme.id }}-{{ role | replace: "_", "-" }}: transparent;
          {% else %}
            /* color to hex */
            {% assign role_hex = role_value | color_to_hex %}
            /* color to hsl */
            {% assign role_hsl = role_hex | color_to_hsl %}
            /* color to css variable */
            --color-{{ scheme.id }}-{{ role | replace: "_", "-" }}: {{ role_hsl }};
            /* color to css variable hover */
            --color-{{ scheme.id }}-{{ role | replace: "_", "-" }}-hover: {{ role_hsl | color_lighten: 5 }};
          {% endif %}
        {% endfor %}
      {% endfor %}
    }

    /* Color css variable to html class */
    {% for scheme in settings.color_schemes %}
      {% if forloop.first %}
        body {
          background-color: var(--color-{{ scheme.id }}-background);
          color: var(--color-{{ scheme.id }}-text);
        }
      {% endif %}
      .bg-{{ scheme.id }} {
        background-color: var(--color-{{ scheme.id }}-background);
      }
      .bg-after-{{ scheme.id }}:after {
        background-color: var(--color-{{ scheme.id }}-text);
      }
      .bg-accent-{{ scheme.id }} {
        background: var(--color-{{ scheme.id }}-button);
      }
      .text-{{ scheme.id }} {
        color: var(--color-{{ scheme.id }}-text);
      }
      .text-secondary-{{ scheme.id }} {
        color: var(--color-{{ scheme.id }}-text-secondary);
      }
      .text-accent-{{ scheme.id }} {
        color: var(--color-{{ scheme.id }}-button-label);
      }
      .brand-highlight-{{ scheme.id }} {
        color: var(--color-{{ scheme.id }}-brand-highlight);
      }
      .btn-disabled-{{ scheme.id }} {
        color: var(--color-{{ scheme.id }}-text-secondary);
        border: 1px solid var(--color-{{ scheme.id }}-text-secondary);
      }
      .btn-primary-{{ scheme.id }} {
        background-color: var(--color-{{ scheme.id }}-button);
        color: var(--color-{{ scheme.id }}-button-label);
        border: 1px solid var(--color-{{ scheme.id }}-button-border);
      }
      .btn-primary-{{ scheme.id }}:not([disabled]):hover,
      .btn-primary-{{ scheme.id }}:not([disabled]):focus,
      .btn-primary-{{ scheme.id }}:not([disabled]):active {
        background-color: var(--color-{{ scheme.id }}-primary-button-hover);
        color: var(--color-{{ scheme.id }}-primary-button-label-hover);
      }
      .btn-primary-{{ scheme.id }}[disabled] {
        opacity: 0.2;
        pointer-events: none;
      }
      .btn-secondary-{{ scheme.id }} {
        color: var(--color-{{ scheme.id }}-secondary-button-label);
        border: 1px solid var(--color-{{ scheme.id }}-secondary-button-border);
      }
      .btn-secondary-{{ scheme.id }}:not([disabled]):hover,
      .btn-secondary-{{ scheme.id }}:not([disabled]):focus,
      .btn-secondary-{{ scheme.id }}:not([disabled]):active {
        color: var(--color-{{ scheme.id }}-secondary-button-label-hover);
        border: 1px solid var(--color-{{ scheme.id }}-secondary-button-border-hover);
      }
      .btn-secondary-{{ scheme.id }}[disabled] {
        opacity: 0.6;
        pointer-events: none;
      }
      .decoration-accent-{{ scheme.id }} {
        text-decoration-color: var(--color-{{ scheme.id }}-button);
      }
      .decoration-accent-hover-{{ scheme.id }}:hover {
        text-decoration-color: var(--color-{{ scheme.id }}-button);
      }
      .border-color-{{ scheme.id }} {
        border-color: var(--color-{{ scheme.id }}-borders-and-inputs);
      }
      .border-accent-{{ scheme.id }} {
        border-color: var(--color-{{ scheme.id }}-button-border);
      }
      .border-secondary-{{ scheme.id }} {
        border-color: var(--color-{{ scheme.id }}-secondary-button-border);
      }
      .border-secondary-{{ scheme.id }}:hover {
        border-color: var(--color-{{ scheme.id }}-secondary-button-border-hover);
      }
    {% endfor %}
{% endstyle %}
