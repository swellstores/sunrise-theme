{% liquid
  assign color_scheme = section.settings.color_scheme
  assign content_color_scheme = section.settings.content_color_scheme
  assign transparent = section.settings.transparent
  assign content_alignment = section.settings.content_alignment
  assign opacity = section.settings.overlay_opacity | times: 0.01
%}

<div
  class="
        w-full relative bg-{{ color_scheme }}
        h-auto
    {% case section.settings.text_alignment %}
      {% when 'center' %} text-center
      {% when 'right' %} text-right
      {% else %} text-left
      {% endcase %}
  "
>
  <div class="relative w-full h-full">
    <div
      class="
        relative w-full
           {% case section.settings.banner_height %}
           {% when 'small' %} h-48 sm:min-h-48 sm:max-h-48
           {% when 'medium' %} h-96 sm:min-h-96 sm:max-h-96
           {% when 'large' %}h-[600px] sm:min-h-[600px] sm:max-h-[600px] 2xl:min-h-[800px] 2xl:max-h-[800px]
           {% when 'screen' %} h-screen
           {% else %} h-auto
         {% endcase %}
        overflow-hidden
      "
    >
      {% if section.settings.image == blank %}
        {% assign pictureClass = 'svg-placeholder' %}
      {% endif %}
      {% render 'image',
        placeholder: 'lifestyle-1',
        image: section.settings.image,
        picture_class: pictureClass,
        class: 'w-full h-full object-cover object-center'
      %}
    </div>
    <div
      class="absolute inset-0 bg-black"
      style="background-color: {{ section.settings.overlay_color }}; opacity: {{ opacity }};"
    ></div>
  </div>
  {%- if section.blocks.size > 0 -%}
    <div class="absolute inset-0 w-full h-full pl-[24px] pr-[24px] lg:pl-[160px] lg:pr-[160px]">
      <div class="max-w-container m-auto w-full h-full flex {{ content_alignment }}">
        <div
          class="
            flex flex-col gap-[32px] max-w-[454px] p-6
            {% if transparent %}bg-transparent text-{{ section.settings.color_scheme }} {% else %}bg-{{ content_color_scheme }} text-{{ content_color_scheme }} {% endif %}
            {% if content_alignment == 'items-center justify-start' %}
            {% elsif content_alignment == 'items-center justify-end' %}
            {% else %}
            {% endif %}
            {% case section.settings.text_alignment %}
            {% when 'center' %} items-center
            {% when 'right' %} items-end
            {% else %} items-start
            {% endcase %}
          "
          style="
            {% if content_alignment contains 'items-start' %} padding-top: {{ section.settings.vertical_padding }}px; {% endif %}
            {% if content_alignment contains 'items-end' %} padding-bottom: {{ section.settings.vertical_padding }}px; {% endif %}
          "
        >
          <div class="flex flex-col gap-[8px]">
            {%- for block in section.blocks -%}
              {%- case block.type -%}
                {%- when 'pre_heading' -%}
                  <p class="font-display text-title-medium font-pre-heading">
                    {{ block.settings.pre_heading }}
                  </p>
                {%- when 'heading' -%}
                  <h2
                    class="
                      font-display
                      font-heading
                      {% case section.settings.heading_size %}
                       {% when 'small' %}text-display-small
                        {% when 'medium' %}text-display-medium
                         {% when 'large' %}text-display-large
                          {% endcase %}
                    "
                  >
                    {{ block.settings.heading | inline_editable: 'heading' }}
                  </h2>
                {%- when 'text' -%}
                  <div class="font-display text-body-large sm:text-body-large">
                    {{ block.settings.text }}
                  </div>
              {%- endcase -%}
            {%- endfor -%}
          </div>
          {%- for block in section.blocks -%}
            {%- if transparent == false -%}
              {%- assign button_color_scheme = content_color_scheme -%}
            {%- else -%}
              {%- assign button_color_scheme = color_scheme -%}
            {%- endif -%}
            {%- case block.type -%}
              {%- when 'button' -%}
                <div class="flex">
                  {% render 'button',
                    text: block.settings.button_label,
                    href: block.settings.button_link,
                    variant: block.settings.button_variant,
                    content_color_scheme: button_color_scheme
                  %}
                </div>
            {%- endcase -%}
          {%- endfor -%}
        </div>
      </div>
    </div>
  {%- endif -%}
</div>

{% schema %}
{
  "name": "Image banner",
  "tag": "section",
  "disabled_on": {
    "groups": ["header", "footer"]
  },
  "settings": [
    {
      "type": "header",
      "content": "Content"
    },
    {
      "type": "image_picker",
      "id": "image",
      "label": "Background image"
    },
    {
      "type": "color",
      "id": "overlay_color",
      "label": "Overlay color",
      "default": "#000000"
    },
    {
      "type": "range",
      "id": "overlay_opacity",
      "label": "Image overlay",
      "default": 0,
      "min": 0,
      "max": 60,
      "step": 10,
      "unit": "%"
    },
    {
      "type": "select",
      "id": "banner_height",
      "label": "Banner height",
      "default": "large",
      "options": [
        {
          "value": "adapt",
          "label": "Adapt to image"
        },
        {
          "value": "small",
          "label": "Small"
        },
        {
          "value": "medium",
          "label": "Medium"
        },
        {
          "value": "large",
          "label": "Large"
        },
        {
          "value": "screen",
          "label": "Adapt to screen"
        }
      ]
    },
    {
      "type": "select",
      "id": "heading_size",
      "label": "Heading size",
      "default": "medium",
      "options": [
        {
          "value": "small",
          "label": "Small"
        },
        {
          "value": "medium",
          "label": "Medium"
        },
        {
          "value": "large",
          "label": "Large"
        }
      ]
    },
    {
      "type": "select",
      "id": "text_alignment",
      "label": "Text alignment",
      "default": "left",
      "options": [
        {
          "value": "left",
          "label": "Left"
        },
        {
          "value": "center",
          "label": "Center"
        },
        {
          "value": "right",
          "label": "Right"
        }
      ]
    },
    {
      "type": "header",
      "content": "Colors"
    },
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-1"
    },
    {
      "type": "color_scheme",
      "id": "content_color_scheme",
      "label": "Content color scheme",
      "default": "scheme-1"
    },
    {
      "type": "header",
      "content": "Layout"
    },
    {
      "type": "select",
      "id": "content_alignment",
      "label": "Content position",
      "default": "items-end justify-start",
      "options": [
        {
          "value": "items-start justify-start",
          "label": "Top left"
        },
        {
          "value": "items-start justify-center",
          "label": "Top middle"
        },
        {
          "value": "items-start justify-end",
          "label": "Top right"
        },
        {
          "value": "items-center justify-start",
          "label": "Middle left"
        },
        {
          "value": "items-center justify-center",
          "label": "Middle center"
        },
        {
          "value": "items-center justify-end",
          "label": "Middle right"
        },
        {
          "value": "items-end justify-start",
          "label": "Bottom left"
        },
        {
          "value": "items-end justify-center",
          "label": "Bottom middle"
        },
        {
          "value": "items-end justify-end",
          "label": "Bottom right"
        }
      ]
    },
    {
      "type": "range",
      "id": "vertical_padding",
      "label": "Vertical padding",
      "default": 16,
      "min": 4,
      "max": 160,
      "step": 4,
      "unit": "px"
    },
    {
      "type": "checkbox",
      "id": "transparent",
      "label": "Transparent background",
      "info": "This will override the color scheme.",
      "default": false
    }
  ],
  "blocks": [
    {
      "type": "pre_heading",
      "name": "Pre-heading",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "pre_heading",
          "label": "Pre-heading",
          "default": "Special offer"
        }
      ]
    },
    {
      "type": "heading",
      "name": "Heading",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "heading",
          "label": "Heading",
          "default": "Unlock exclusive savings"
        }
      ]
    },
    {
      "type": "text",
      "name": "Text",
      "limit": 1,
      "settings": [
        {
          "type": "inline_richtext",
          "id": "text",
          "label": "Text"
        }
      ]
    },
    {
      "type": "button",
      "name": "Button",
      "limit": 1,
      "settings": [
        {
          "type": "text",
          "id": "button_label",
          "label": "Button label",
          "info": "Leave the label blank to hide the button.",
          "default": "Button"
        },
        {
          "type": "url",
          "id": "button_link",
          "label": "Button link"
        },
        {
          "type": "select",
          "id": "button_variant",
          "label": "Button style",
          "options": [
            {
              "value": "solid",
              "label": "Solid"
            },
            {
              "value": "outline",
              "label": "Outline"
            }
          ],
          "default": "solid"
        }
      ]
    }
  ],
  "presets": [
    {
      "name": "Hero",
      "blocks": [
        {
          "type": "pre_heading",
          "settings": {
            "pre_heading": "Special offer"
          }
        },
        {
          "type": "heading",
          "settings": {
            "heading": "Unlock exclusive savings"
          }
        },
        {
          "type": "text",
          "settings": {
            "text": "Add your message here to highlight what's special. Use the image below to draw attention and guide visitors to discover more on your site."
          }
        }
      ]
    }
  ]
}
{% endschema %}
