{%- liquid
  assign color_scheme = section.settings.color_scheme
  assign terms = search.terms | escape
-%}

<div class="bg-{{ color_scheme }} text-{{ color_scheme }} px-24 py-32 flex flex-col">
  <div class="flex flex-col items-center w-full">
    <div class="flex flex-col items-start w-full max-w-766 mx-auto gap-16 pb-32">
      <h2 class="text-title-large font-display">
        {%- if search.performed -%}
          Search results
        {%- else -%}
          Search
        {%- endif -%}
      </h2>
      <form action="{{ routes.search_url }}" method="get" role="search" class="flex items-center w-full">
        <div class="relative w-766">
          <input name="options[prefix]" type="hidden" value="last">
          {% assign placeholder_text = 'general.search.placeholder' | t %}
          {% render 'input',
            id: 'search',
            name: 'q',
            value: terms,
            aria_required: 'true',
            autocorrect: 'off',
            autocapitalize: 'off',
            autocomplete: 'off',
            placeholder: placeholder_text,
            variant: 'search'
          %}
          <button
            type="submit"
            class="absolute inset-y-0 right-0 flex items-center pr-16 cursor-pointer"
            aria-label="{{ 'general.search.submit' | t }}"
          >
            {{ 'search-dialog-icon.svg' | inline_asset_content }}
          </button>
        </div>
      </form>
    </div>
  </div>
  <div class="max-w-container mx-auto pb-32 mt-32 border-t border-[#E0E0E0] sm:p-24 w-full">
    {% paginate search.results by 24 %}
      <div class="max-w-content mx-auto 2xl:max-w-container w-full">
        {%- if search.performed and search.results.size > 0 -%}
          {% render 'filter-bar', request: request, results: search, paginate: paginate %}
        {%- endif -%}

        {%- if search.performed -%}
          {%- if search.results.size == 0 -%}
            <div class="mt-8 text-body-medium">{{ 'general.search.no_results' | t: terms: terms }}</div>
          {%- else -%}
            <div id="results" class="flex w-full flex-col gap-32">
              <div class="grid grid-cols-2  gap-x-16 gap-y-24 md:grid-cols-3 lg:grid-cols-4">
                {%- for item in search.results -%}
                  {%- case item.object_type -%}
                    {%- when 'product' -%}
                      {% render 'product-card', product: item %}
                    {%- when 'article' -%}
                    {%- when 'page' -%}
                  {%- endcase -%}
                {%- endfor -%}
              </div>
            </div>

            {%- if paginate.pages > 1 -%}
              {% render 'pagination', paginate: paginate, color_scheme: color_scheme %}
            {%- endif -%}
          {%- endif -%}
        {%- endif -%}
      </div>
    {% endpaginate %}
  </div>
</div>

{% schema %}
{
  "name": "Search",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-1"
    },
    {
      "type": "range",
      "id": "columns",
      "label": "Columns",
      "info": "Columns are used to organize content within a section.",
      "min": 3,
      "max": 7,
      "step": 2,
      "default": 5
    },
    {
      "type": "range",
      "id": "gap",
      "label": "Gap",
      "info": "Gap between columns",
      "min": 0,
      "max": 100,
      "step": 4,
      "default": 12
    }
  ]
}
{% endschema %}
