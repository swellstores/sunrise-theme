{%- liquid
  assign color_scheme = section.settings.color_scheme
  assign top_padding = section.settings.top_padding | times: 0.1 | round: 1
  assign bottom_padding = section.settings.bottom_padding | times: 0.1 | round: 1
  assign reduced_padding_top = top_padding | times: 0.55 | round: 2
  assign reduced_padding_bottom = bottom_padding | times: 0.55 | round: 2
-%}

{% style %}
  .responsive-padding-{{ section.id }} {
    padding-top: {{ reduced_padding_top }}rem;
    padding-bottom: {{ reduced_padding_bottom }}rem;
  }

  @media (min-width: 1024px) {
    .responsive-padding-{{ section.id }} {
      padding-top: {{ top_padding }}rem;
      padding-bottom: {{ bottom_padding }}rem;
    }
  }
{% endstyle %}

<div class="bg-{{ color_scheme }} all-blogs max-w-container mx-auto p-24 md:pl-160 md:pr-160 md:pt-64 md:pb-64 responsive-padding-{{ section.id }}">
  <div class="blogs-list">
    {% for link in linklists.blogs.links %}
      {% assign blog = link.object %}
      <div class="blog-category pb-64 flex flex-col gap-32 max-w-content">
        <div class="flex flex-col gap-32">
          <h1 class="text-display-medium font-display text-center">{{ blog.title }}</h1>

          <div class="flex flex-col ">
            <div class="featured-article flex flex-col items-center gap-16">
              {% assign featured_article = blog.articles[0] %}
              {% if featured_article.image %}
                <div class="w-full max-w-content h-auto">
                  <img
                    src="{{ featured_article.image | image_url }}"
                    alt="{{ featured_article.title }}"
                    class="w-full h-full object-cover"
                    height=""
                    width=""
                  >
                </div>
              {% endif %}
              <div class="flex flex-col gap-16 items-center">
                <div class="flex flex-col gap-4 items-center">
                  <div>
                    <p class="font-display text-body-medium text-secondary-{{ section.settings.color_scheme }}">
                      {{ featured_article.published_at | date: '%B %d %Y' }}
                    </p>
                  </div>
                  <div>
                    <h2 class="font-display text-headline-large">{{ featured_article.title }}</h2>
                  </div>
                </div>
                {% if featured_article.excerpt %}
                  <p class="font-display text-body-large text-center max-w-550">
                    {{ featured_article.excerpt | truncate: 150 }}
                  </p>
                {% endif %}
              </div>
            </div>
          </div>
        </div>

        <div class="articles grid grid-cols-1 sm:grid-cols-[repeat(auto-fit,minmax(33.8rem,2fr))] md:grid-cols-[repeat(auto-fit,minmax(33.8rem,2fr))] lg:grid-cols-[repeat(auto-fit,minmax(33.8rem,3fr))] gap-16">
          {% for article in blog.articles offset: 1 %}
            <div class="blog-card flex flex-col gap-16 overflow-hidden">
              {% if article.image %}
                <div class="h-250 sm:w-full">
                  <img
                    src="{{ article.image | image_url }}"
                    alt="{{ article.title }}"
                    class="w-full h-full object-cover"
                    height=""
                    width=""
                  >
                </div>
              {% endif %}
              <div class="flex flex-col gap-16">
                <div class="flex flex-col gap-4">
                  <p class="text-body-medium font-display text-secondary-{{ section.settings.color_scheme }}">
                    {{ article.published_at | date: '%B %d %Y' }}
                  </p>
                  <h3 class="font-display text-headline-small">
                    <a href="{{ article.url }}" class="hover:underline">{{ article.title }}</a>
                  </h3>
                </div>
                {% if article.excerpt %}
                  <p class="text-body-large font-display">{{ article.excerpt | truncate: 100 }}</p>
                {% endif %}
                <div class="flex">
                  {% assign read_more_text = 'sections.blog.read_more' | t %}
                  {% render 'button',
                    text: read_more_text,
                    href: article.url,
                    color_scheme: section.settings.color_scheme
                  %}
                </div>
              </div>
            </div>
          {% endfor %}
        </div>
      </div>
    {% endfor %}
  </div>
</div>

{% schema %}
{
  "name": "All Blogs",
  "tag": "section",
  "class": "section",
  "settings": [
    {
      "type": "color_scheme",
      "id": "color_scheme",
      "label": "Color scheme",
      "default": "scheme-1"
    },
    {
      "type": "range",
      "id": "top_padding",
      "label": "Top padding",
      "min": 0,
      "max": 96,
      "step": 1,
      "unit": "px",
      "default": 40
    },
    {
      "type": "range",
      "id": "bottom_padding",
      "label": "Bottom padding",
      "min": 0,
      "max": 96,
      "step": 1,
      "unit": "px",
      "default": 40
    }
  ]
}
{% endschema %}
